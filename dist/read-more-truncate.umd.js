(function(H,a){typeof exports=="object"&&typeof module<"u"?a(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],a):(H=typeof globalThis<"u"?globalThis:H||self,a(H.ReadMoreTruncate={},H.Vue))})(this,function(H,a){"use strict";var q={};Object.defineProperty(q,"__esModule",{value:!0});var ce=["area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"],K=["address","article","aside","blockquote","canvas","dd","div","dl","dt","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","li","main","nav","noscript","ol","output","p","pre","section","table","tbody","tfoot","thead","tr","ul","video"],D=["audio","math","svg","video"],R=10,fe=33,de=34,ue=38,ve=39,V=47,z=59,N=60,_e=61,I=62,me=/[<&\n\ud800-\udbff]/,pe=/[<&\ud800-\udbff]/,Ee=/\s+/g;function He(e,r,i){return i===void 0&&(i={}),e?(e=e.toString(),i.html?Te(e,r,i):Ce(e,r,i)):""}var be=q.default=He;function Te(e,r,i){for(var l=i.imageWeight,h=l===void 0?2:l,d=i.indicator,u=d===void 0?"…":d,y=i.maxLines,p=y===void 0?1/0:y,s=i.stripTags,g=s===void 0?!1:s,o=u.length,v=1,E=typeof g=="boolean"?function(){return g}:function(T){return g.includes(T)},f=[],b=function(T){for(var x;x=f.pop(),x!==void 0;)E(x)||(T+="</"+x+">");return T},t=0,_=-1,ee=e.length;t<ee;t++){var k=t?e.slice(t):e,te=Ae(f),ze=_>-1||te?pe:me,W=k.search(ze),w=W>-1?W:k.length;if(_===-1){if(te){var A=Me(w===k.length?k:k.slice(0,W));if(E(f[f.length-1])){var re=t>0&&!C(e.charCodeAt(t-1)),ie=!C(e.charCodeAt(t+w));A.length>0?A=(re?" ":"")+A+(ie?" ":""):re&&ie&&(A=" "),e=e.slice(0,t)+A+e.slice(t+w),w=A.length}if(o+=A.length,o>r)break}else if(o+=w,o>r){t=Math.max(t+w-o+r,0);break}}if(t+=w,W===-1)break;var m=e.charCodeAt(t);if(m===N){var F=e.charCodeAt(t+1),ae=F===fe;if(ae&&e.substr(t+2,2)==="--"){var Ie=e.indexOf("-->",t+4)+3;t=Ie-1}else if(ae&&e.substr(t+2,7)==="[CDATA["){var Ue=e.indexOf("]]>",t+9)+3;t=Ue-1}else{var U=F===V;if(o===r&&!U){o++;break}for(var P=0,c=t,O=!1;;){if(c++,c>=ee)throw new Error("Invalid HTML: "+e);var S=e.charCodeAt(c);if(O)P?S===P&&(O=!1):C(S)?O=!1:S===I&&(O=!1,c--);else if(S===_e){for(;C(e.charCodeAt(c+1));)c++;O=!0;var X=e.charCodeAt(c+1);X===de||X===ve?(P=X,c++):P=0}else if(S===I){var le=t+(U?2:1),Xe=Math.min(we(e,le),c),n=e.slice(le,Xe).toLowerCase();n.charCodeAt(n.length-1)===V&&(n=n.slice(0,n.length-1));var G=E(n);if(U){var qe=f.pop();if(qe!==n)throw new Error("Invalid HTML: "+e);if(D.includes(n)&&!D.some(function(T){return f.includes(T)})){if(G)t=_,_=-1;else if(_=-1,o+=h,o>r)break}var Ke=K.includes(n);if(Ke&&_===-1&&!G&&(v++,v>p)){f.push(n);break}}else if(ce.includes(n)||e.charCodeAt(c-1)===V){if(!G){if(n==="br"){if(v++,v>p)break}else if(n==="img"&&(o+=h,o>r))break}}else D.some(function(T){return f.includes(T)})||D.includes(n)&&(_=t),f.push(n);G&&_===-1?(e=e.slice(0,t)+e.slice(c+1),t--):t=c;break}}if(o>r||v>p)break}}else if(m===ue){for(var c=t+1,oe=!0;;){var ne=e.charCodeAt(c);if(Y(ne))c++;else{if(ne===z)break;oe=!1;break}}if(_===-1&&(o++,o>r))break;oe&&(t=c)}else if(m===R){if(o++,o>r||(v++,v>p))break}else{if(_===-1&&(o++,o>r))break;if((m&64512)===55296){var F=e.charCodeAt(t+1);(F&64512)===56320&&t++}}}if(o>r){var L=Re(e,t);if(u){for(var M=t+L.length;e.charCodeAt(M)===N&&e.charCodeAt(M+1)===V;){var he=e.indexOf(">",M+2)+1;if(he)M=he;else break}M&&(M===e.length||J(e,M))&&(t+=L.length,L=e.charAt(t))}for(;L==="<"&&e.charCodeAt(t+1)===V;){var n=f.pop();if(!n)break;var $=e.indexOf(">",t+2);if($===-1||e.slice(t+2,$).trim()!==n)throw new Error("Invalid HTML: "+e);E(n)?e=e.slice(0,t)+e.slice($+1):t=$+1,L=e.charAt(t)}if(t<e.length){if(!i.breakWords)for(var B=t-u.length;B>=0;B--){var m=e.charCodeAt(B);if(m===I||m===z)break;if(m===R||m===N){t=B;break}else if(C(m)){t=B+(u?1:0);break}}var se=e.slice(0,t);return J(e,t)||(se+=u),b(se)}}else if(v>p)return b(e.slice(0,t));return e}function Ce(e,r,i){for(var l=i.indicator,h=l===void 0?"…":l,d=i.maxLines,u=d===void 0?1/0:d,y=h.length,p=1,s=0,g=e.length;s<g&&(y++,!(y>r));s++){var o=e.charCodeAt(s);if(o===R){if(p++,p>u)break}else if((o&64512)===55296){var v=e.charCodeAt(s+1);(v&64512)===56320&&s++}}if(y>r){var E=Q(e,s);if(h){var f=s+E.length;if(f===e.length)return e;if(e.charCodeAt(f)===R)return e.slice(0,s+E.length)}if(!i.breakWords)for(var b=s-h.length;b>=0;b--){var o=e.charCodeAt(b);if(o===R){s=b,E=`
`;break}else if(C(o)){s=b+(h?1:0);break}}return e.slice(0,s)+(E===`
`?"":h)}else if(p>u)return e.slice(0,s);return e}function we(e,r){for(var i=e.length,l=r;l<i;l++)if(C(e.charCodeAt(l)))return l;return i}function Y(e){return e>=48&&e<=57||e>=65&&e<=90||e>=97&&e<=122}function J(e,r){var i=e.charCodeAt(r);if(i===R)return!0;if(i===N){var l="("+K.join("|")+"|br)",h=new RegExp("^<"+l+`[	
\f\r ]*/?>`,"i");return h.test(e.slice(r))}else return!1}function C(e){return e===9||e===10||e===12||e===13||e===32}function Ae(e){for(var r=e.length-1;r>=0;r--){var i=e[r];if(i==="li"||i==="td")return!1;if(i==="ol"||i==="table"||i==="ul")return!0}return!1}function Me(e){return e.trim().replace(Ee," ")}function Q(e,r){var i=e.charCodeAt(r);if((i&64512)===55296){var l=e.charCodeAt(r+1);if((l&64512)===56320)return String.fromCharCode(i,l)}return String.fromCharCode(i)}function Re(e,r){var i=Q(e,r);if(i==="&")for(;;){r++;var l=e.charCodeAt(r);if(Y(l))i+=String.fromCharCode(l);else if(l===z){i+=String.fromCharCode(l);break}else break}return i}const ye={methods:{async waitForElementHeight(e,r=3e3){return new Promise((i,l)=>{e.clientHeight&&i(e.clientHeight);const h=new ResizeObserver(()=>{e.clientHeight&&(i(e.clientHeight),h.disconnect())});h.observe(e,{childList:!0,subtree:!0,attribute:!0}),setTimeout(()=>{l(),h.disconnect()},r)})}}},Ye="",Ve=(e,r)=>{const i=e.__vccOpts||e;for(const[l,h]of r)i[l]=h;return i},ge={props:{truncateValue:{type:Number,default:null},onlyIfMoreThanValue:{type:Number,default:null},readMoreButtonText:{type:String,default:"Read more"},readLessButtonText:{type:String,default:"Read less"}},mixins:[ye],data:()=>({clippedHTML:"",expandHeightValue:null,collapseHeightValue:null,isExpanded:!1,readMoreButtonVisible:!1,isResized:!1,wrongContainerHeightValue:!1}),methods:{toggle(){this.isExpanded=!this.isExpanded,this.truncateMethod()},addReadMore(){this.matchTextLength().then(e=>{this.readMoreButtonVisible=e})},async matchTextLength(){return this.countCharacters()>this.onlyIfMoreThanValue&&this.truncateValue<this.countCharacters()},countCharacters(){return new DOMParser().parseFromString(this.htmlString,"text/html").querySelector("body").innerText.length},truncateCharacters(e){this.clippedHTML=be(this.htmlString,e,{html:!0})},truncateMethod(){this.expandHeightValue-this.collapseHeightValue<=15&&!this.initialTruncate&&(this.resetHeight(),this.wrongContainerHeightValue=!0),!this.isExpanded&&this.truncateOnlyIfMoreThan?(!this.initialTruncate&!this.isInViewport(this.$refs.scrollRef)&&this.$refs.scrollRef.scrollIntoView({behavior:"smooth",block:"center"}),this.truncateCharacters(this.truncateValue)):this.truncateCharacters(1e6),this.wrongContainerHeightValue&&(this.wrongContainerHeightValue=!1,this.expandHeight(),setTimeout(()=>{this.collapseHeight()},500)),this.initialTruncate=!1},resetHeight(){this.expandHeightValue="auto",this.collapseHeightValue="auto"},onResizeMethod(){this.wrongContainerHeightValue=!0,this.resetHeight()},expandHeight(){this.waitForElementHeight(this.$refs.htmlRef).then(()=>{var e;this.expandHeightValue=(e=this.$refs.htmlRef)==null?void 0:e.clientHeight}).catch(()=>{console.warn("Could not get clientHeight of element with ref: htmlRef")})},collapseHeight(){this.waitForElementHeight(this.$refs.contentBox).then(()=>{var e;this.collapseHeightValue=(e=this.$refs.contentBox)==null?void 0:e.clientHeight}).catch(()=>{console.warn("Could not get clientHeight of element with ref: contentBox")})},isInViewport(e){const r=e.getBoundingClientRect();return r.top>=0&&r.left>=0&&r.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&r.right<=(window.innerWidth||document.documentElement.clientWidth)}},async mounted(){this.initialTruncate=!0,this.truncateMethod(),this.addReadMore(),this.$nextTick(()=>{window.addEventListener("resize",this.onResizeMethod)}),this.expandHeight(),this.collapseHeight()},beforeDestroy(){window.removeEventListener("resize",this.onResizeMethod)},computed:{htmlString(){return this.$refs.htmlRef.innerHTML},displayHeight(){return this.expandHeightValue==="auto"||this.collapseHeightValue==="auto"?"height: auto":this.isExpanded&&this.expandHeightValue!=="auto"?`height: ${this.expandHeightValue}px`:`height: ${this.collapseHeightValue}px`},truncateOnlyIfMoreThan(){return this.countCharacters()>this.onlyIfMoreThanValue}}},Z=e=>(a.pushScopeId("data-v-d0683042"),e=e(),a.popScopeId(),e),ke={class:"truncate-read-more"},Oe={ref:"scrollRef"},Se={style:{position:"relative"}},Le={ref:"htmlRef",style:{visibility:"hidden",position:"absolute","z-index":"-1"},class:"rte readmore__content readmore__content--htmlRef"},Be=["innerHTML"],De={key:0,class:"readmore-button-container",style:{"margin-top":"0.5rem"}},Ne={viewBox:"0 0 19 12",fill:"currentColor",style:{width:"9.3765px",height:"5.5855px","margin-right":"0.3rem","margin-bottom":"0.15rem"}},We=[Z(()=>a.createElementVNode("path",{d:"M8.879.204a.702.702 0 0 1 1 0l8.672 8.6a.702.702 0 0 1 0 1l-1.16 1.16a.702.702 0 0 1-1 0L9.377 4.019l-7.014 6.943a.702.702 0 0 1-1 0l-1.16-1.16a.702.702 0 0 1 0-1L8.879.204z"},null,-1))],Fe={viewBox:"0 0 18.753 11.171",fill:"currentColor",style:{width:"9.3765px",height:"5.5855px","margin-right":"0.3rem","margin-bottom":"0.1rem"}},Pe=[Z(()=>a.createElementVNode("path",{d:"M8.879 10.964a.7.7 0 0 0 1 0l8.672-8.6a.7.7 0 0 0 0-1l-1.16-1.16a.7.7 0 0 0-1 0L9.377 7.149 2.363.206a.7.7 0 0 0-1 0l-1.16 1.16a.7.7 0 0 0 0 1z"},null,-1))];function Ge(e,r,i,l,h,d){return a.openBlock(),a.createElementBlock("div",ke,[a.createElementVNode("div",Oe,null,512),a.createElementVNode("div",Se,[a.createElementVNode("div",Le,[a.renderSlot(e.$slots,"html",{},void 0,!0)],512)]),a.createElementVNode("div",{ref:"contentBox",style:a.normalizeStyle(d.displayHeight),class:"rte readmore__content readmore__content--contentBox"},[a.createElementVNode("div",{innerHTML:e.isExpanded?d.htmlString:e.clippedHTML},null,8,Be)],4),e.readMoreButtonVisible?(a.openBlock(),a.createElementBlock("div",De,[e.isExpanded?(a.openBlock(),a.createElementBlock("div",{key:0,class:"truncate-read-more__button",onClick:r[0]||(r[0]=(...u)=>d.toggle&&d.toggle(...u))},[(a.openBlock(),a.createElementBlock("svg",Ne,We)),a.createTextVNode(" "+a.toDisplayString(i.readLessButtonText),1)])):a.createCommentVNode("",!0),e.isExpanded?a.createCommentVNode("",!0):(a.openBlock(),a.createElementBlock("div",{key:1,class:"truncate-read-more__button",onClick:r[1]||(r[1]=(...u)=>d.toggle&&d.toggle(...u))},[(a.openBlock(),a.createElementBlock("svg",Fe,Pe)),a.createTextVNode(" "+a.toDisplayString(i.readMoreButtonText),1)]))])):a.createCommentVNode("",!0)])}const j=Ve(ge,[["render",Ge],["__scopeId","data-v-d0683042"]]),$e=e=>{e.component("truncate-read-more",j)},xe={install:e=>{$e(e)}};H.TruncateReadMore=j,H.VueTruncateReadMore=xe,Object.defineProperty(H,Symbol.toStringTag,{value:"Module"})});
